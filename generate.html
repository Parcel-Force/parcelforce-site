<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Generate Invoice</title>
  <meta name="description" content="Generate branded ParcelForce invoices." />
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="favicon.ico" />
  <style>
    /* (unchanged styling from your original, tuned slightly) */
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f2f2f2;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    body.dark-mode { background-color: #1f1f1f; color: #f0f0f0; }

    h1 { text-align:center; color:#d6001c; margin-top:40px; margin-bottom:30px; font-size:32px; letter-spacing:1px; font-weight:700; }
    body.dark-mode h1 { color:#ff6b6b; }

    form#invoiceForm {
      max-width: 600px;
      margin: 30px auto;
      background-color: #fcfcfc;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
      transition: opacity 0.3s ease;
    }
    body.dark-mode form#invoiceForm { background-color: #2c2c2c; box-shadow: 0 6px 20px rgba(0,0,0,0.3); }

    .form-section { margin-bottom: 30px; }
    .form-section h3 {
      color: #d6001c;
      font-size: 18px;
      margin-bottom: 15px;
      margin-top: 0;
      border-bottom: 2px solid #d6001c;
      padding-bottom: 8px;
    }
    body.dark-mode .form-section h3 { color: #ff6b6b; border-bottom-color: #ff6b6b; }

    label { display:block; margin-top:16px; margin-bottom:6px; font-weight:600; color:#444; font-size:14px; }
    body.dark-mode label { color:#e0e0e0; }

    input[type="text"], input[type="email"], input[type="number"], textarea, select {
      width:100%; padding:12px; margin-top:6px; border:1px solid #ccc; border-radius:6px; background-color:#f9f9f9;
      font-size:16px; color:#333; box-sizing:border-box; transition: border-color .3s, background-color .3s, box-shadow .3s;
    }
    input:focus, textarea:focus, select:focus { outline:none; border-color:#d6001c; background-color:#fff; box-shadow:0 0 0 3px rgba(214,0,28,0.1); }
    body.dark-mode input, body.dark-mode textarea, body.dark-mode select { background-color:#333; border-color:#555; color:#f0f0f0; }
    body.dark-mode input:focus, body.dark-mode textarea:focus, body.dark-mode select:focus { border-color:#ff6b6b; background-color:#404040; box-shadow:0 0 0 3px rgba(255,107,107,0.2); }

    select { cursor:pointer; appearance:none; background-repeat:no-repeat; background-position: right 12px center; padding-right:36px; }

    textarea { resize:vertical; min-height:80px; font-family:'Segoe UI',sans-serif; }

    .preview-box {
      background:#e8f5e9; padding:15px; border:1px solid #81c784; border-left:4px solid #4caf50; border-radius:6px; margin-top:15px;
      font-weight:700; font-size:14px; line-height:1.6;
    }
    body.dark-mode .preview-box { background:#1e4620; border-color:#51cf66; border-left-color:#51cf66; color:#f0f0f0; }

    button[type="submit"] {
      display:block; width:100%; margin-top:30px; padding:14px; background-color:#d6001c; color:white; font-weight:bold;
      font-size:16px; border:none; border-radius:6px; cursor:pointer; transition: background-color .3s, transform .2s;
    }
    button[type="submit"]:hover:not(:disabled) { background-color:#b00018; transform:translateY(-2px); }
    button[type="submit"]:disabled { background-color:#ccc; cursor:not-allowed; opacity:0.6; }
    body.dark-mode button[type="submit"] { background-color:#c8102e; }
    body.dark-mode button[type="submit"]:hover:not(:disabled) { background-color:#ff6b6b; }

    .spinner { display:none; margin:20px auto; border:4px solid #f3f3f3; border-top:4px solid #d6001c; border-radius:50%; width:40px; height:40px; animation:spin 1s linear infinite; }
    @keyframes spin { to { transform:rotate(360deg); } }
    body.dark-mode .spinner { border-color:#444; border-top-color:#ff6b6b; }

    #successBanner { display:none; background:#d4edda; color:#155724; padding:15px; margin-top:20px; border-left:5px solid #28a745; border-radius:6px; font-weight:600; animation:slideIn .3s ease; }
    body.dark-mode #successBanner { background:#1e4620; color:#51cf66; border-left-color:#51cf66; }
    @keyframes slideIn { from { opacity:0; transform:translateY(-10px);} to { opacity:1; transform:translateY(0);} }

    .error-message { display:none; background:#f8d7da; color:#721c24; padding:15px; margin-top:20px; border-left:5px solid #d6001c; border-radius:6px; font-weight:600; animation:slideIn .3s ease; }
    body.dark-mode .error-message { background:#4a1e1e; color:#ff6b6b; border-left-color:#ff6b6b; }

    /* responsive */
    @media (max-width:600px) {
      body { padding:10px; }
      h1 { font-size:24px; margin-top:20px; }
      form#invoiceForm { padding:20px; margin:20px auto; }
      .form-section h3 { font-size:16px; }
      input, textarea, select { font-size:16px; padding:14px; }
      button[type="submit"] { padding:16px; font-size:18px; }
      .preview-box { padding:12px; font-size:13px; }
    }

    /* accessibility */
    @media (prefers-reduced-motion: reduce) {
      * { animation-duration:0.01ms !important; animation-iteration-count:1 !important; transition-duration:0.01ms !important; }
    }
    *:focus-visible { outline:2px solid #d6001c; outline-offset:2px; }
    body.dark-mode *:focus-visible { outline-color:#ff6b6b; }
  </style>
</head>
<body>
  <div id="header"></div>

  <main>
    <h1>Generate Invoice</h1>
    <form id="invoiceForm" novalidate>
      <div class="form-section">
        <h3>Sender Details</h3>
        <label for="senderName">Sender Name *</label>
        <input id="senderName" type="text" required placeholder="Enter sender name" />

        <label for="senderEmail">Sender Email *</label>
        <input id="senderEmail" type="email" required placeholder="sender@example.com" />

        <label for="senderContact">Sender Contact</label>
        <input id="senderContact" type="text" placeholder="Phone number (optional)" />
      </div>

      <div class="form-section">
        <h3>Recipient Details</h3>
        <label for="recipientName">Recipient Name *</label>
        <input id="recipientName" type="text" required placeholder="Enter recipient name" />

        <label for="recipientEmail">Recipient Email *</label>
        <input id="recipientEmail" type="email" required placeholder="recipient@example.com" />

        <label for="recipientContact">Recipient Contact</label>
        <input id="recipientContact" type="text" placeholder="Phone number (optional)" />
      </div>

      <div class="form-section">
        <h3>Item Details</h3>
        <label for="itemDescription">Item Description *</label>
        <textarea id="itemDescription" required placeholder="Describe the item being shipped"></textarea>

        <label for="itemQty">Quantity *</label>
        <input id="itemQty" type="number" min="1" value="1" required />

        <label for="itemPrice">Unit Price (£) *</label>
        <input id="itemPrice" type="number" min="0" step="0.01" value="0.00" required />

        <div class="preview-box" aria-live="polite">
          Subtotal: <span id="subtotalPreview">£0.00</span><br>
          VAT (20%): <span id="vatPreview">£0.00</span><br>
          Total: <span id="totalPreview">£0.00</span>
        </div>
      </div>

      <div class="form-section">
        <h3>Delivery Details</h3>
        <label for="status">Delivery Status *</label>
        <select id="status" required>
          <option value="">Select Status</option>
          <option value="Pending">Pending</option>
          <option value="Picked Up">Picked Up</option>
          <option value="In Transit">In Transit</option>
          <option value="Out for Delivery">Out for Delivery</option>
          <option value="Delivered">Delivered</option>
          <option value="Failed Delivery">Failed Delivery</option>
        </select>

        <label for="zone">Delivery Zone *</label>
        <input id="zone" type="text" required placeholder="e.g., Zone A, London" />
      </div>

      <div class="form-section">
        <label for="adminNotes">Admin Notes</label>
        <textarea id="adminNotes" placeholder="Optional notes for internal use"></textarea>
      </div>

      <div id="errorMsg" class="error-message" role="alert" aria-live="assertive"></div>
      <div id="successBanner" role="status" aria-live="polite">✅ Invoice generated successfully! Redirecting to receipt...</div>
      <div class="spinner" id="loadingSpinner" aria-hidden="true" aria-label="Loading"></div>

      <button type="submit" id="generateBtn">Generate Invoice</button>
    </form>
  </main>

  <div id="footer"></div>

  <script type="module" src="generate.js"></script>
  <script>
    // minimal layout include (safe)
    async function loadLayout() {
      try {
        const [headerRes, footerRes] = await Promise.all([
          fetch('header.html').then(r => r.ok ? r.text() : ''),
          fetch('footer.html').then(r => r.ok ? r.text() : '')
        ]);
        if (headerRes) document.getElementById('header').innerHTML = headerRes;
        if (footerRes) document.getElementById('footer').innerHTML = footerRes;
      } catch (e) {
        console.warn('Layout include failed', e);
      }
    }
    loadLayout();
  </script>
</body>
</html>